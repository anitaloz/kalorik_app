create table serving_units
(
    id bigserial primary key,
    name varchar(50)
);
create table food
(
    id           bigserial
        primary key,
    name         varchar(255),
    calories     double precision,
    bel          double precision,
    fats         double precision,
    ch           double precision,
    serving_unit bigserial,
    serving_size double precision,
    CONSTRAINT fk_unit
        FOREIGN KEY (serving_unit)
            REFERENCES serving_units(id)
);
create table usr
(
    id       bigserial
        primary key,
    username varchar(50)  not null
        unique,
    password varchar(255) not null,
    active   varchar(30)
);
create table meals
(
    id         bigserial
        primary key,
    user_id    bigint
        references usr,
    meal_date  date not null,
    meal_title varchar(50)
);
create table meal_food_items
(
    meal_id      bigint           not null
        references meals
            on delete cascade,
    food_item_id bigint           not null
        references food
            on delete cascade,
    quantity     double precision not null,
    primary key (meal_id, food_item_id)
);
create table user_info
(
    id             bigserial
        primary key,
    username       varchar(50) not null
        unique
        references usr (username),
    first_name     varchar(50),
    last_name      varchar(50),
    date_of_birth  date,
    gender         varchar(10),
    height_cm      integer,
    weight_kg      numeric(5, 2),
    activity_level varchar(50),
    caloriesnum    integer,
    purpose        varchar(30),
    desired_weight numeric(5, 2)
);
create table user_role
(
    user_id bigint      not null
        references usr,
    roles   varchar(30) not null,
    primary key (user_id, roles)
);

-- Inserting some basic food items

-- Заполнение таблицы serving_units

INSERT INTO serving_units (name) VALUES ('грамм');
INSERT INTO serving_units (name) VALUES ('штука');
INSERT INTO serving_units (name) VALUES ('столовая ложка');
INSERT INTO serving_units (name) VALUES ('чайная ложка');
INSERT INTO serving_units (name) VALUES ('стакан');
INSERT INTO serving_units (name) VALUES ('порция');
INSERT INTO serving_units (name) VALUES ('миллилитр');

-- Заполнение таблицы food

INSERT INTO food (name, calories, bel, fats, ch, serving_unit, serving_size)
VALUES ('Яблоко', 52, 0.3, 0.2, 14, 2, 1); -- 1 штука

INSERT INTO food (name, calories, bel, fats, ch, serving_unit, serving_size)
VALUES ('Куриная грудка (вареная)', 165, 31, 3.6, 0, 1, 100); -- 100 грамм

INSERT INTO food (name, calories, bel, fats, ch, serving_unit, serving_size)
VALUES ('Овсяная каша (на воде)', 68, 3, 1.4, 12, 1, 100); -- 100 грамм

INSERT INTO food (name, calories, bel, fats, ch, serving_unit, serving_size)
VALUES ('Оливковое масло', 884, 0, 100, 0, 3, 1); -- 1 столовая ложка

INSERT INTO food (name, calories, bel, fats, ch, serving_unit, serving_size)
VALUES ('Сахар', 387, 0, 0, 100, 4, 1); -- 1 чайная ложка

INSERT INTO food (name, calories, bel, fats, ch, serving_unit, serving_size)
VALUES ('Молоко (2.5% жирности)', 52, 3.4, 2.5, 5, 5, 200); -- 200 мл (стакан)

INSERT INTO food (name, calories, bel, fats, ch, serving_unit, serving_size)
VALUES ('Творог (5% жирности)', 121, 16.6, 5, 1.8, 1, 100); -- 100 грамм

INSERT INTO food (name, calories, bel, fats, ch, serving_unit, serving_size)
VALUES ('Хлеб (белый)', 265, 9, 3.2, 49, 1, 100); -- 100 грамм

INSERT INTO food (name, calories, bel, fats, ch, serving_unit, serving_size)
VALUES ('Рис (вареный)', 130, 2.7, 0.3, 28, 1, 100); -- 100 грамм

INSERT INTO food (name, calories, bel, fats, ch, serving_unit, serving_size)
VALUES ('Суп овощной', 50, 1.5, 2, 7, 6, 300); -- 300 грамм (порция)

INSERT INTO food (name, calories, bel, fats, ch, serving_unit, serving_size)
VALUES ('Вода', 0, 0, 0, 0, 7, 100); -- 100 миллилитров

INSERT INTO food (name, calories, bel, fats, ch, serving_unit, serving_size)
VALUES ('Гречка (вареная)', 110, 4.5, 1.5, 20, 1, 100); -- 100 грамм
